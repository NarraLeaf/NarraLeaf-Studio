# æ‰“å¼€é¡¹ç›®å·¥ä½œæµç¨‹å®ç°æ€»ç»“

## æ¦‚è¿°

å·²å®Œæˆä» Launcher é€‰æ‹©æ–‡ä»¶å¤¹å¹¶æ‰“å¼€ä¸º Workspace çš„å®Œæ•´æµç¨‹å®ç°ã€‚æ­¤å®ç°åŒ…æ‹¬ IPC é€šä¿¡ã€ä¸»è¿›ç¨‹å¤„ç†ã€æ¸²æŸ“è¿›ç¨‹ UI ä»¥åŠå¿…è¦çš„æœåŠ¡ã€‚

## å®ç°å†…å®¹

### 1. IPC é€šä¿¡å±‚ (Shared Types)

#### æ–‡ä»¶: `src/shared/types/ipcEvents.ts`
- æ·»åŠ äº†æ–°çš„ IPC äº‹ä»¶ç±»å‹ï¼š
  - `IPCEventType.workspaceLaunch` - å¯åŠ¨ Workspace çª—å£
  - `IPCEventType.workspaceSelectFolder` - é€‰æ‹©æ–‡ä»¶å¤¹
- å®šä¹‰äº† `IPCWorkspaceEvents` ç±»å‹ï¼ŒåŒ…å«äº‹ä»¶çš„æ•°æ®å’Œå“åº”ç»“æ„

#### æ–‡ä»¶: `src/shared/types/renderer.ts`
- åœ¨ `RendererPreloadedInterface` ä¸­æ·»åŠ äº†ä¸¤ä¸ªæ–°æ–¹æ³•ï¼š
  - `openWindow(props, closeCurrentWindow?)` - æ‰“å¼€ Workspace çª—å£
  - `selectFolder()` - æ‰“å¼€æ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†

### 2. Preload å±‚ (Main Process)

#### æ–‡ä»¶: `src/main/preload/ipc/interface.ts`
- å®ç°äº†æ¸²æŸ“è¿›ç¨‹æ¥å£çš„å…·ä½“æ–¹æ³•
- é€šè¿‡ `ipcClient.invoke()` è°ƒç”¨ä¸»è¿›ç¨‹çš„ IPC handlers

### 3. ä¸»è¿›ç¨‹å¤„ç†å™¨ (Main Process)

#### æ–‡ä»¶: `src/main/app/application/managers/window/handlers/workspaceAction.ts` (æ–°å»º)
åˆ›å»ºäº†ä¸¤ä¸ª IPC å¤„ç†å™¨ï¼š

1. **WorkspaceLaunchHandler**
   - å¤„ç† Workspace çª—å£å¯åŠ¨è¯·æ±‚
   - è°ƒç”¨ `app.launchWorkspace()` åˆ›å»ºçª—å£
   - æ”¯æŒæ‰“å¼€åå…³é—­å½“å‰çª—å£çš„é€‰é¡¹

2. **WorkspaceSelectFolderHandler**
   - æ˜¾ç¤º Electron çš„æ–‡ä»¶å¤¹é€‰æ‹©å¯¹è¯æ¡†
   - è¿”å›é€‰æ‹©çš„æ–‡ä»¶å¤¹è·¯å¾„æˆ– nullï¼ˆå–æ¶ˆï¼‰

#### æ–‡ä»¶: `src/main/app/application/managers/windowManager.ts`
- å¯¼å…¥äº† workspace handlers
- åœ¨ `registerDefaultIPCHandlers()` ä¸­æ³¨å†Œè¿™äº› handlers
- ç¡®ä¿æ‰€æœ‰çª—å£éƒ½èƒ½å¤„ç† workspace ç›¸å…³çš„ IPC è¯·æ±‚

### 4. æ¸²æŸ“è¿›ç¨‹ UI (Launcher)

#### æ–‡ä»¶: `src/renderer/apps/launcher/tabs/ProjectsTab.tsx`
é‡æ„äº† Projects æ ‡ç­¾é¡µï¼Œæ·»åŠ ï¼š

- **"Open Folder" æŒ‰é’®**
  - æ˜¾ç¤º folder å›¾æ ‡
  - ç‚¹å‡»æ—¶è°ƒç”¨ `handleOpenFolder()`
  - æœ‰åŠ è½½çŠ¶æ€é˜²æ­¢é‡å¤ç‚¹å‡»

- **handleOpenFolder() å‡½æ•°**
  ```typescript
  1. è°ƒç”¨ selectFolder() é€‰æ‹©æ–‡ä»¶å¤¹
  2. éªŒè¯è¿”å›ç»“æœ
  3. å¦‚æœç”¨æˆ·é€‰æ‹©äº†æ–‡ä»¶å¤¹ï¼Œè°ƒç”¨ openWindow()
  4. ä¼ é€’é¡¹ç›®è·¯å¾„å’Œå…³é—­å½“å‰çª—å£çš„é€‰é¡¹
  5. é”™è¯¯å¤„ç†
  ```

- **æ”¹è¿›çš„ UI**
  - æŒ‰é’®å¸ƒå±€æ›´åˆç†ï¼ˆOpen Folder + New Projectï¼‰
  - æ·»åŠ äº†ä½¿ç”¨è¯´æ˜
  - ç¦ç”¨çŠ¶æ€å’ŒåŠ è½½æç¤º

### 5. Workspace æœåŠ¡å±‚ (Renderer)

#### æ–‡ä»¶: `src/renderer/lib/workspace/services/core/UIService.ts` (æ–°å»º)
å®ç°äº† UI æœåŠ¡ï¼Œæä¾›ï¼š
- `showConfirm()` - ç¡®è®¤å¯¹è¯æ¡†
- `showAlert()` - è­¦å‘Šå¯¹è¯æ¡†
- `showNotification()` - é€šçŸ¥æ¶ˆæ¯
- `showError()` - é”™è¯¯æ¶ˆæ¯

ç›®å‰ä½¿ç”¨æµè§ˆå™¨åŸç”Ÿ APIï¼Œé¢„ç•™äº†è‡ªå®šä¹‰ UI ç»„ä»¶çš„æ‰©å±•ç‚¹ã€‚

#### æ–‡ä»¶: `src/renderer/lib/workspace/services/services.ts`
- åœ¨ `Services` enum ä¸­æ·»åŠ äº† `UI = "ui"`
- å®šä¹‰äº† `IUIService` æ¥å£

#### æ–‡ä»¶: `src/renderer/lib/workspace/services/serviceRegistry.ts`
- å¯¼å…¥ `UIService`
- åœ¨æœåŠ¡æ³¨å†Œè¡¨ä¸­æ³¨å†Œ UI æœåŠ¡

## æ•°æ®æµ

### å®Œæ•´æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. ç”¨æˆ·æ“ä½œ                                                 â”‚
â”‚    User clicks "Open Folder" button in Launcher             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. æ¸²æŸ“è¿›ç¨‹ - Launcher                                      â”‚
â”‚    ProjectsTab.handleOpenFolder()                            â”‚
â”‚    - Call getInterface().selectFolder()                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 3. Preload Bridge                                            â”‚
â”‚    ipcClient.invoke(workspaceSelectFolder)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 4. ä¸»è¿›ç¨‹ Handler                                           â”‚
â”‚    WorkspaceSelectFolderHandler                              â”‚
â”‚    - Show Electron dialog                                    â”‚
â”‚    - Return selected path                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. æ¸²æŸ“è¿›ç¨‹ - Launcher (continued)                          â”‚
â”‚    - Receive folder path                                     â”‚
â”‚    - Call getInterface().openWindow({ projectPath })         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 6. Preload Bridge                                            â”‚
â”‚    ipcClient.invoke(workspaceLaunch, { props, close... })    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 7. ä¸»è¿›ç¨‹ Handler                                           â”‚
â”‚    WorkspaceLaunchHandler                                    â”‚
â”‚    - Call app.launchWorkspace(props)                         â”‚
â”‚    - Create new BrowserWindow                                â”‚
â”‚    - Load Workspace HTML                                     â”‚
â”‚    - (Optional) Close Launcher window                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 8. æ¸²æŸ“è¿›ç¨‹ - Workspace                                     â”‚
â”‚    WorkSpaceApp renders                                      â”‚
â”‚    - WorkspaceProvider initializes                           â”‚
â”‚    - Create Workspace context                                â”‚
â”‚    - Initialize services (FileSystem, Project, UI)           â”‚
â”‚    - Render WorkspaceLayout                                  â”‚
â”‚    - Load Assets panel                                       â”‚
â”‚    - Show Welcome editor                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å…³é”®è®¾è®¡å†³ç­–

### 1. è§£è€¦è®¾è®¡
- IPC é€šä¿¡å±‚å®Œå…¨ç‹¬ç«‹
- ä¸»è¿›ç¨‹ handlers å¯å¤ç”¨
- æ¸²æŸ“è¿›ç¨‹é€šè¿‡ bridge è°ƒç”¨ï¼Œä¸ç›´æ¥ä¾èµ– Electron

### 2. é”™è¯¯å¤„ç†
- æ¯ä¸ªæ­¥éª¤éƒ½æœ‰é”™è¯¯æ£€æŸ¥
- ä½¿ç”¨ `RequestStatus<T>` ç»Ÿä¸€é”™è¯¯å“åº”æ ¼å¼
- UI å±‚æä¾›å‹å¥½çš„é”™è¯¯æç¤º

### 3. çŠ¶æ€ç®¡ç†
- ä½¿ç”¨ `isOpening` çŠ¶æ€é˜²æ­¢é‡å¤æ“ä½œ
- æ¸…æ™°çš„åŠ è½½çŠ¶æ€åé¦ˆ
- å¼‚æ­¥æ“ä½œçš„ try-catch åŒ…è£…

### 4. å¯æ‰©å±•æ€§
- UI æœåŠ¡æä¾›äº†åŸºç¡€æ–¹æ³•ï¼Œæ˜“äºæ‰©å±•
- Handler æ¨¡å¼ä¾¿äºæ·»åŠ æ–°åŠŸèƒ½
- æœåŠ¡æ³¨å†Œè¡¨æ”¯æŒåŠ¨æ€æ·»åŠ æœåŠ¡

## æµ‹è¯•è¦ç‚¹

### åŠŸèƒ½æµ‹è¯•
- âœ… ç‚¹å‡» "Open Folder" æŒ‰é’®
- âœ… æ–‡ä»¶é€‰æ‹©å¯¹è¯æ¡†æ­£ç¡®æ˜¾ç¤º
- âœ… é€‰æ‹©æ–‡ä»¶å¤¹å Workspace çª—å£æ‰“å¼€
- âœ… Launcher çª—å£æ­£ç¡®å…³é—­
- âœ… Workspace æ­£ç¡®åˆå§‹åŒ–æœåŠ¡
- âœ… å–æ¶ˆé€‰æ‹©æ–‡ä»¶å¤¹æ—¶æ­£å¸¸å¤„ç†

### è¾¹ç¼˜æƒ…å†µ
- âœ… å¿«é€Ÿè¿ç»­ç‚¹å‡»æŒ‰é’®ï¼ˆé˜²æŠ–å¤„ç†ï¼‰
- âœ… é€‰æ‹©ä¸å­˜åœ¨çš„è·¯å¾„
- âœ… IPC é€šä¿¡å¤±è´¥
- âœ… æœåŠ¡åˆå§‹åŒ–å¤±è´¥

## æ–‡ä»¶æ¸…å•

### æ–°å»ºæ–‡ä»¶
```
src/main/app/application/managers/window/handlers/workspaceAction.ts
src/renderer/lib/workspace/services/core/UIService.ts
WORKFLOW_TEST.md
IMPLEMENTATION_SUMMARY.md (æœ¬æ–‡ä»¶)
```

### ä¿®æ”¹æ–‡ä»¶
```
src/shared/types/ipcEvents.ts
src/shared/types/renderer.ts
src/main/preload/ipc/interface.ts
src/main/app/application/managers/windowManager.ts
src/renderer/apps/launcher/tabs/ProjectsTab.tsx
src/renderer/lib/workspace/services/services.ts
src/renderer/lib/workspace/services/serviceRegistry.ts
```

## åç»­ä¼˜åŒ–å»ºè®®

### çŸ­æœŸ
1. **é¡¹ç›®éªŒè¯**
   - æ£€æŸ¥é€‰æ‹©çš„æ–‡ä»¶å¤¹æ˜¯å¦åŒ…å« `project.json`
   - å¦‚æœä¸æ˜¯æœ‰æ•ˆé¡¹ç›®ï¼Œæç¤ºç”¨æˆ·æˆ–è‡ªåŠ¨åˆ›å»ºç»“æ„

2. **æœ€è¿‘é¡¹ç›®**
   - ä½¿ç”¨ `GlobalState` ä¿å­˜æœ€è¿‘æ‰“å¼€çš„é¡¹ç›®
   - åœ¨ Launcher ä¸­æ˜¾ç¤ºæœ€è¿‘é¡¹ç›®åˆ—è¡¨
   - æ”¯æŒç‚¹å‡»å¿«é€Ÿæ‰“å¼€

3. **é”™è¯¯æç¤ºä¼˜åŒ–**
   - ä½¿ç”¨è‡ªå®šä¹‰ Modal æ›¿ä»£ browser åŸç”Ÿ alert
   - Toast é€šçŸ¥ç³»ç»Ÿ
   - è¯¦ç»†çš„é”™è¯¯æ—¥å¿—

### é•¿æœŸ
1. **é¡¹ç›®ç®¡ç†å¢å¼º**
   - é¡¹ç›®æ”¶è—åŠŸèƒ½
   - é¡¹ç›®æ ‡ç­¾/åˆ†ç±»
   - é¡¹ç›®æœç´¢

2. **å¤šé¡¹ç›®æ”¯æŒ**
   - åŒæ—¶æ‰“å¼€å¤šä¸ª Workspace
   - é¡¹ç›®é—´åˆ‡æ¢
   - å·¥ä½œåŒºä¿å­˜å’Œæ¢å¤

3. **äº‘åŒæ­¥**
   - é¡¹ç›®åˆ—è¡¨äº‘åŒæ­¥
   - æœ€è¿‘é¡¹ç›®è·¨è®¾å¤‡å…±äº«

## æ€»ç»“

âœ… **å·²å®Œæˆçš„ç›®æ ‡ï¼š**
- å®ç°äº†å®Œæ•´çš„"é€‰æ‹©æ–‡ä»¶å¤¹ â†’ æ‰“å¼€ Workspace"æµç¨‹
- æ‰€æœ‰ç»„ä»¶è§£è€¦ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•
- å®Œå–„çš„é”™è¯¯å¤„ç†å’ŒçŠ¶æ€ç®¡ç†
- å®ç°äº† UI æœåŠ¡ä¸ºæœªæ¥åŠŸèƒ½åšå‡†å¤‡
- æ—  Linter é”™è¯¯ï¼Œä»£ç è´¨é‡è‰¯å¥½

ğŸ¯ **æµç¨‹å·²å®Œå…¨å¯ç”¨ï¼**

ç”¨æˆ·ç°åœ¨å¯ä»¥ï¼š
1. å¯åŠ¨åº”ç”¨æŸ¥çœ‹ Launcher
2. ç‚¹å‡» "Open Folder" é€‰æ‹©é¡¹ç›®æ–‡ä»¶å¤¹
3. Workspace çª—å£è‡ªåŠ¨æ‰“å¼€å¹¶åŠ è½½é¡¹ç›®
4. å¼€å§‹ä½¿ç”¨å®Œæ•´çš„ IDE åŠŸèƒ½

---

**å®ç°æ—¥æœŸï¼š** 2025-11-04
**ç‰ˆæœ¬ï¼š** v0.1.0 (MVP)

